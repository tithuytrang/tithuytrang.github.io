(function(e,t,n){"use strict";e.extend(!0,t.cart,{ecommerce:function(r){r=e.extend(!0,{settings:{indexpage:"cart/index.html",loginpage:"imlogin.php",vat:0,coupon:!1,vattype:"none",currency:"â‚¬",currency_id:"EUR",currency_format:"#.###,@@[C]",currency_format_zeroas:"0",post_url:"cart/x5cart.php",order_no_format:"[yy][mm][dd]-[A-Z][0-9][A-Z][0-9]",form_autocomplete:!0,form_validation:"tip",showShipmentFields:!1,continue_shopping_page:"index.html",remove_from_cart_icon:"cart/images/cart-remove.png",add_to_cart_icon:"cart/images/cart-add.png",minimumAmount:0,currencies:["USD","EUR"],cartCookie:"x5CartProducts",formCookie:"x5CartForm",lastOrderCookie:"x5CartLastOrder",registerUsers:0},products:{},shippings:{},payments:{},form:{fields:{},agreement:"",acceptAgreement:!1}},r);var i={},s=null,o=null,u={},a=0,f={},l=0,c=null,h=null,p=null,d=0,v={},m={},g="",y=this,b="fj293ur2/we02",w=[-2,-4,-1,-3,-2,-5,-1],E={"x5cart.priceChanged":e.Callbacks(),"x5cart.quantityChanged":e.Callbacks()};for(var S in r.shippings)r.shippings[S]&&(l++,f[S]=new t.cart.shipping(r.shippings[S]));for(var x in r.payments)r.payments[x]&&(a++,u[x]=new t.cart.payment(r.payments[x]));this.formatCurrency=function(e,n,i){i=i||r.settings.currency,n=n||r.settings.currency_format,n.match(/(\[C\]\s?)?[#]+(,|\.|\s)?[#]*(,|\.)?([@]*)(\s?\[C\])?/gi);var s=t.utils,o=RegExp.$2,u=RegExp.$3,a=RegExp.$4,f=RegExp.$1,l=RegExp.$5,c="",h=s.round(e,a.length),p=0|h,d=s.round(h-p,a.length),v=0,m;if(e===0&&r.settings.currency_format_zeroas=="-")return"-";!!o.length&&!u.length&&!!a.length&&(u=o,o=""),p+="",v=p.length;for(m=v-1;m>=0;m--)(v-m-1)%3===0&&v-m-1>0&&(c=o+c),c=p.charAt(m)+c;if(a.length){d=(d+"").replace(/0\./,"").substring(0,a.length);while(d.length<a.length)d+="0";c+=u+d}return(f?f.replace("[C]",i):"")+c+(l?l.replace("[C]",i):"")},this.settings=function(t){return t&&e.extend(r.settings,t),r.settings},this.form=function(){return r.form},this.updateUserData=function(){var i=e.Deferred(),s=this;return!t.utils.isOnline()||r.settings.registerUsers===0||r.settings.registerUsers===2&&n.location.hash.indexOf("guest_order")!==-1?(i.resolve(),i):(e.ajax({url:"../"+r.settings.post_url+"?action=userdata&"+Math.round(Math.random()*1e4),type:"GET",dataType:"json",success:function(e){if(e.success){var t,n,o=function(e){for(var t=0;t<r.form.fields.length;t++)if(r.form.fields[t].id==e)return r.form.fields[t].name};if(s.isSetUserData()){t=s.userInvoiceData();for(n=0;n<e.invoiceData.length;n++)e.invoiceData[n].field_id=="Email"&&(t.Email.value=e.invoiceData[n].value);s.userInvoiceData(t,!0)}else{if(!!e.invoiceData){t={};for(n=0;n<e.invoiceData.length;n++)t[e.invoiceData[n].field_id]={value:e.invoiceData[n].value,label:o(e.invoiceData[n].field_id)};s.userInvoiceData(t,!0)}if(!!e.shippingData){t={};for(n=0;n<e.shippingData.length;n++)t[e.shippingData[n].field_id]={value:e.shippingData[n].value,label:o(e.shippingData[n].field_id)};s.userShippingData(t,!0)}}i.resolve()}else i.reject()},error:function(){i.reject()}}),i)},this.add=function(n,s,o,u,a){var f=e.Deferred(),l=this,c=new t.cart.product(r.products[n],{quantity:s,option:o,suboption:u,postUrl:r.settings.post_url,onProductCreated:function(e,t){e.done(function(){var e=t.hash(),n=function(){i[e]=t,l.save(),E["x5cart.priceChanged"].fire(),E["x5cart.quantityChanged"].fire(),f.resolve(e)};e in i&&!a?t.setQuantity(i[e].quantity()+s).done(n).fail(function(e){f.reject(e)}):n()}).fail(function(e){f.reject(e)})}});return f.promise()},this.remove=function(e){if(e in i&&!!i[e]){var t={};for(var n in i)n!=e&&(t[n]=i[n]);return i=t,this.save(),E["x5cart.priceChanged"].fire(),E["x5cart.quantityChanged"].fire(),!0}return!1},this.update=function(n,r,s,o){var u=e.Deferred();n in i||(u.reject({message:t.l10n.get("cart_product_unknown","Unknown product")}),u.promise());var a=i[n],f=this;return a.quiet(!1),s&&a.option()!=s||!isNaN(o)&&a.subOption()!=o?this.add(a.id(),r,s?s:a.option(),isNaN(o)?a.subOption():o).done(function(e){var t={};for(var r in i)r!=e&&r!=n&&(t[r]=i[r]),r==n&&(t[e]=i[e]);i=t,E["x5cart.priceChanged"].fire(),f.save(),u.resolve(e)}).fail(function(e){u.reject(e)}):i[n].quantity()!=r?i[n].setQuantity(r).done(function(){E["x5cart.priceChanged"].fire(),E["x5cart.quantityChanged"].fire(),f.save(),u.resolve(n)}).fail(function(e){u.reject(e)}):u.resolve(n),u.promise()},this.cart=function(){return i},this.count=function(e){e=e!==null&&e!==undefined?e:!0;var t=0;for(var n in i)t+=e?i[n].quantity()*1:1;return t},this.category=function(e){var n={},i=null;for(var s in r.products)i=r.products[s],i.category==e&&(n[s]=new t.cart.product(r.products[i.id],{quiet:!0}));return n},this.store=function(e){var n;if(!e){var i={},s;for(n in r.products)s=r.products[n],i[n]=new t.cart.product(s,{quiet:!0});return i}return e in r.products?(n=r.products[e],new t.cart.product(n,{quiet:!0})):null},this.shippings=function(){return f},this.shippingsCount=function(){return l},this.allowedShippings=function(){var e=this.cart();for(var t in e)if(e[t].base().physical_delivery)return this.shippings();return{}},this.allowedShippingsCount=function(){var e=this.cart();for(var t in e)if(e[t].base().physical_delivery)return this.shippingsCount();return 0},this.payments=function(){return u},this.paymentsCount=function(){return a},this.payment=function(e,t){return t=t===null||t===undefined?!0:t,e&&u[e]&&(o=e,t&&this.save()),E["x5cart.priceChanged"].fire(),o!==null&&u[o]?u[o]:null},this.shipping=function(e,t){return t=t===null||t===undefined?!0:t,e&&f[e]&&(s=e,t&&this.save()),E["x5cart.priceChanged"].fire(),s!==null&&f[s]?f[s]:null},this.userInvoiceData=function(e,t){return t=t===null||t===undefined?!0:t,e!==null&&e!==undefined&&(v=e,t&&this.save()),v?v:[]},this.userShippingData=function(e,t){return t=t===null||t===undefined?!0:t,!e||(m=e,t&&this.save()),m},this.vat=function(){var e=this.goodsVat()+(s&&f[s]&&this.count()?f[s].vat(this.goodsWeight(),this.goodsPrice(r.settings.vattype=="included")):0)+(o&&u[o]&&this.count()?this.paymentVat(o):0);return Math.max(0,e)},this.cartDiscount=function(){var e=this.goodsPrice(!0),t=s&&f[s]&&this.count()?f[s].price(!0,this.goodsWeight(),this.goodsPrice(!0)):0,n=o&&u[o]&&this.count()?this.paymentPrice(o,!0,!1):0,r=0;if(h=="absolute")r=d;else if(h=="relative"){var i=e+(p?t+n:0);r=i*d}return r},this.fullPrice=function(e){return this.goodsFullPrice(e)+(s&&f[s]&&this.count()?f[s].price(e,this.goodsWeight(),this.goodsPrice(r.settings.vattype=="included")):0)+(o&&u[o]&&this.count()?this.paymentPrice(o,e,!0):0)},this.price=function(e,t){typeof t=="undefined"&&(t=!1);var n=this.goodsPrice(e)+(s&&f[s]&&this.count()?f[s].price(e,this.goodsWeight(),this.goodsPrice(r.settings.vattype=="included")):0)+(o&&u[o]&&this.count()?this.paymentPrice(o,e,!1):0);return t?Math.max(0,n-this.cartDiscount()):Math.max(0,n)},this.paymentPrice=function(e,t,n){e=e||o,typeof n=="undefined"&&(n=!1);var i=r.settings.vattype=="included",a=function(e,t){var r=n?t.goodsFullPrice(e):t.goodsPrice(e);return s&&f[s]&&t.count()&&(r+=f[s].price(e,t.goodsWeight(),r)),r};return!e||!u[e]?0:u[e].price(a(i,this),t)},this.paymentVat=function(e,t){e=e||o,typeof t=="undefined"&&(t=!1);var n=r.settings.vattype=="included",i=function(e,n){var r=t?n.goodsFullPrice(e):n.goodsPrice(e);return s&&f[s]&&n.count()&&(r+=f[s].price(e,n.goodsWeight(),r)),r};return!e||!u[e]?0:u[e].vat(i(n,this))},this.goodsFullPrice=function(e){var t=0;for(var n in i)i[n]&&(t+=i[n].fullPrice(e));return t},this.goodsPrice=function(e){var t=0;for(var n in i)i[n]&&(t+=i[n].price(e));return t},this.goodsWeight=function(){var e=0;for(var t in i)i[t]&&(e+=i[t].weight());return e},this.goodsVat=function(){return this.goodsPrice(!0)-this.goodsPrice(!1)},this.coupon=function(n,s,o){var u,a=this;s=s===null||s===undefined?!0:s;if(!!n){d=0,h=null,p=null,c=null;for(u in i)i[u].disableCoupon();if(!t.utils.isOnline()){if(r.settings.coupon!==!1&&n in r.settings.coupon){var f=new Date,l=!0;f=new Date(f.getUTCFullYear(),f.getUTCMonth(),f.getUTCDate(),f.getUTCHours(),f.getUTCMinutes(),f.getUTCSeconds());if("start_date"in r.settings.coupon[n]&&r.settings.coupon[n].start_date>=f||"end_date"in r.settings.coupon[n]&&r.settings.coupon[n].end_date<=f)l=!1;l&&(c=n,h=r.settings.coupon[c].type,d=r.settings.coupon[c].amount,r.settings.coupon[c].apply_on_shipping_and_payment!==undefined&&(p=r.settings.coupon[c].apply_on_shipping_and_payment))}else for(u in i)i[u].enableCoupon(n)&&(c=n);s&&this.save(),e.isFunction(o)&&o(c?c:"")}else e.ajax({url:t.settings.currentPath+r.settings.post_url+"?action=chkcpn&"+Math.round(Math.random()*1e4),type:"POST",async:!1,data:{coupon:n},dataType:"json",success:function(t){if(t!==!1)if(t.type=="cart")c=n,h=t.discount_type,t.apply_on_shipping_and_payment!==undefined&&(p=t.apply_on_shipping_and_payment),d=t.amount;else for(var r in i)e.inArray(i[r].id(),t.ids)!=-1&&(i[r].enableCoupon(n),c=n);s&&a.save(),e.isFunction(o)&&o(c?c:"")}});E["x5cart.priceChanged"].fire()}return c?c:""},this.canApplyCoupon=function(){if(r.settings.coupon!==!1)return!0;for(var e in i)if(i[e].base().discount.coupon)return!0;return!1},this.canSetOrder=function(){var e={success:!1,message:""};return this.count()===0?e.message=t.l10n.get("cart_err_emptycart"):this.allowedShippingsCount()>0&&this.shipping()===null?e.message=t.l10n.get("cart_err_shipping"):a>0&&this.payment()===null?e.message=t.l10n.get("cart_err_payment"):r.settings.minimumAmount>this.goodsPrice(r.settings.vattype=="included")?e.message=t.l10n.get("cart_err_minimum_price").replace(/\[PRICE\]/g,this.formatCurrency(r.settings.minimumAmount)):e.success=!0,e},this.isSetUserData=function(){if(e.isEmptyObject(this.userInvoiceData()))return!1;var t=function(e,t){var n=r.form.fields;for(var i=0;i<n.length;i++)if(n[i].mandatory&&(!t||n[i].shipping)&&(!(n[i].id in e)||!e[n[i].id].value.length))return!1;return!0};return t(this.userInvoiceData(),!1)?!e.isEmptyObject(this.userShippingData())&&!t(this.userShippingData(),!0)?!1:!0:!1},this.paymentHTML=function(i){i=e.extend({target:"html"},i);var s=this.payment()?i.target=="email"?this.payment().emailHtml():this.payment().html():"",o=t.utils.htmlspecialchars,u,a,f,l,c=!0,h=r.form.fields,p=this.userInvoiceData(),d=this.userShippingData(),v=!e.isEmptyObject(d),m=["Company","Name","LastName","Address1","Address2","ZipPostalCode","City","StateRegion","Country","CountryCode","Email","Phone","Mobile","Fax","VAT","CustomerID","Adverts","Note"];if(!s)return"";s=s.replace(/\[ORDER_NO\]/g,g).replace(/\[HESCAPE_ORDER_NO\]/g,o(g)).replace(/\[UESCAPE_ORDER_NO\]/g,n.escape(g)),u=this.formatCurrency(this.price(c,!0),"#.@@@"),s=s.replace(/\[PRICE\]/g,u).replace(/\[HESCAPE_PRICE\]/g,o(u)).replace(/\[UESCAPE_PRICE\]/g,n.escape(u)),s=s.replace(/\[ORDER_ENC_DATA\]/g,this.getStringifiedEncodedData());while(l=s.match(/\[PRICE,\s*([0-9]+),\s*([\w#@\.,\[\]]+)\]/))u=this.price(c,!0)*parseInt(l[1],10),u=this.formatCurrency(u.toString(),l[2]),f=l[0].replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\."),s=s.replace(new RegExp(f,"g"),u);while(l=s.match(/\[(H|U)ESCAPE_PRICE,\s*([0-9]+),\s*([\w#@\.,\[\]]+)\]/))u=this.price(c,!0)*parseInt(l[2],10),u=this.formatCurrency(u.toString(),l[3]),f=l[0].replace(/\[/g,"\\[").replace(/\]/g,"\\]").replace(/\(/g,"\\(").replace(/\)/g,"\\)").replace(/\./g,"\\."),s=s.replace(new RegExp(f,"g"),RegExp.$1=="U"?n.escape(u):o(u));for(var y=0;y<m.length;y++){var b=m[y],w=b.toUpperCase(),E=p[b]?p[b].value:"",S=d[b]?d[b].value:"";s=s.replace(new RegExp("\\["+w+"\\]","g"),E).replace(new RegExp("\\[HESCAPE_"+w+"\\]","g"),o(E)).replace(new RegExp("\\[UESCAPE_"+w+"\\]","g"),n.escape(E)).replace(new RegExp("\\[SHIPPING_"+w+"\\]","g"),v?S:E).replace(new RegExp("\\[HESCAPE_SHIPPING_"+w+"\\]","g"),v?o(S):o(E)).replace(new RegExp("\\[UESCAPE_SHIPPING_"+w+"\\]","g"),v?n.escape(S):n.escape(E))}for(var y=0;y<h.length;y++)if(h[y].custom){var x=h[y].id,T=h[y].name,N=x.toUpperCase(),C=T.toUpperCase(),k=p[x]?p[x].value:"",L=d[x]?d[x].value:"";s=s.replace(new RegExp("\\["+C+"\\]","g"),k).replace(new RegExp("\\[HESCAPE_"+C+"\\]","g"),o(k)).replace(new RegExp("\\[UESCAPE_"+C+"\\]","g"),n.escape(k)).replace(new RegExp("\\[SHIPPING_"+C+"\\]","g"),v?L:k).replace(new RegExp("\\[HESCAPE_SHIPPING_"+C+"\\]","g"),v?o(L):o(k)).replace(new RegExp("\\[UESCAPE_SHIPPING_"+C+"\\]","g"),v?n.escape(L):n.escape(k)).replace(new RegExp("\\["+N+"\\]","g"),k).replace(new RegExp("\\[HESCAPE_"+N+"\\]","g"),o(k)).replace(new RegExp("\\[UESCAPE_"+N+"\\]","g"),n.escape(k)).replace(new RegExp("\\[SHIPPING_"+N+"\\]","g"),v?L:k).replace(new RegExp("\\[HESCAPE_SHIPPING_"+N+"\\]","g"),v?o(L):o(k)).replace(new RegExp("\\[UESCAPE_SHIPPING_"+N+"\\]","g"),v?n.escape(L):n.escape(k))}return s=s.replace(/\[USE_SHIPPING_DATA\]/g,v),s},this.setOrder=function(s){var o=this.canSetOrder(),u={},a={},f,l,c,h;if(o.success!==!0){e.isFunction(s)&&s({success:!1,message:o});return}g=function(){var e=r.settings.order_no_format,t=new Date,n=t.getDate(),i=t.getMonth()+1,s=t.getFullYear().toString().substring(2);parseInt(n,10)<10&&(n="0"+n),parseInt(i,10)<10&&(i="0"+i),e=e.replace(/\[dd\]/g,n).replace(/\[mm\]/g,i).replace(/\[yy\]/g,s).replace(/\[yyyy\]/g,t.getFullYear());while(e.indexOf("[A-Z]")!=-1)e=e.replace("[A-Z]",String.fromCharCode(Math.round(Math.random()*25+65)));while(e.indexOf("[a-z]")!=-1)e=e.replace("[a-z]",String.fromCharCode(Math.round(Math.random()*25+97)));while(e.indexOf("[0-9]")!=-1)e=e.replace("[0-9]",Math.round(Math.random()*9));return e}();var p={success:!0,orderNo:g,shipping:this.shipping(),payment:this.payment(),cart:this.cart(),userInvoiceData:this.userInvoiceData(),userShippingData:this.userShippingData()};this.save();if(!t.utils.isOnline())n.imStorage.setItem(r.settings.lastOrderCookie,g),e.isFunction(s)&&s(p);else{for(c in i)h=i[c],f="options"in h.base()&&h.option()&&h.base().options[h.option()]?h.base().options[h.option()].name:null,l=f&&"suboptions"in h.base().options[h.option()]?h.base().options[h.option()].suboptions[h.subOption()]:null,u[c]={id:h.base().id,name:h.base().name,description:h.base().description,option:f,suboption:l,rawSinglePrice:h.singlePrice(!1),rawSinglePricePlusVat:h.singlePrice(!0),rawSingleFullPrice:h.singleFullPrice(!1),rawSingleFullPricePlusVat:h.singleFullPrice(!0),rawPrice:h.price(!1),rawPricePlusVat:h.price(!0),rawFullPrice:h.fullPrice(!1),rawFullPricePlusVat:h.fullPrice(!0),rawSingleVat:h.singleVat(),rawVat:h.vat(),singlePrice:this.formatCurrency(h.singlePrice(!1)),singlePricePlusVat:this.formatCurrency(h.singlePrice(!0)),singleFullPrice:this.formatCurrency(h.singleFullPrice(!1)),singleFullPricePlusVat:this.formatCurrency(h.singleFullPrice(!0)),price:this.formatCurrency(h.price(!1)),pricePlusVat:this.formatCurrency(h.price(!0)),fullPrice:this.formatCurrency(h.fullPrice(!1)),fullPricePlusVat:this.formatCurrency(h.fullPrice(!0)),vat:this.formatCurrency(h.vat()),singleVat:this.formatCurrency(h.singleVat()),quantity:h.quantity()};a={orderNo:g,userInvoiceData:this.userInvoiceData(),userShippingData:this.userShippingData(),products:u,rawTotalPrice:this.price(!1),rawTotalPricePlusVat:this.price(!0),rawTotalVat:this.vat(),totalPrice:this.formatCurrency(this.price(!1)),totalPricePlusVat:this.formatCurrency(this.price(!0)),totalVat:this.formatCurrency(this.vat()),totalToPay:this.formatCurrency(this.price(!0,!0)),coupon:this.coupon(),rawCouponDiscount:this.cartDiscount(),couponDiscount:this.formatCurrency(this.cartDiscount()),currency:r.settings.currency_id},this.shipping()&&(a=e.extend(a,{shipping:{name:this.shipping().name(),description:this.shipping().description(),icon:this.shipping().base().image,email_text:this.shipping().email(),price:this.formatCurrency(this.shipping().price(!1,this.goodsWeight(),this.goodsPrice(!1))),pricePlusVat:this.formatCurrency(this.shipping().price(!0,this.goodsWeight(),this.goodsPrice(!0))),rawPrice:this.shipping().price(!1,this.goodsWeight(),this.goodsPrice(!1)),rawPricePlusVat:this.shipping().price(!0,this.goodsWeight(),this.goodsPrice(!0)),vat:this.formatCurrency(this.shipping().vat(this.goodsWeight(),this.goodsPrice(r.vattype=="included"))),rawVat:this.shipping().vat(this.goodsWeight(),this.goodsPrice(r.vattype=="included"))}})),this.payment()&&(a=e.extend(a,{payment:{name:this.payment().name(),description:this.payment().description(),icon:this.payment().base().image,price:this.formatCurrency(this.paymentPrice(null,!1)),pricePlusVat:this.formatCurrency(this.paymentPrice(null,!0)),rawPrice:this.paymentPrice(null,!1),rawPricePlusVat:this.paymentPrice(null,!0),email_text:this.payment().email(),vat:this.formatCurrency(this.paymentVat()),rawVat:this.paymentVat(),html:this.paymentHTML({target:"email"}),htmlCheck:'<a href="http://google.it">escapecheck</a>'}}));var d=r.settings.post_url;d+=d.indexOf("?")==-1?"?":"&",e.ajax({url:t.settings.currentPath+d+"action=sndrdr&"+Math.round(Math.random()*1e4),type:"POST",dataType:"json",data:{orderData:a},success:function(i){if(!!i&&"status"in i)if(i.status=="ok")g=i.orderNumber,p.orderNo=i.orderNumber;else{p.success=!1;var o;for(var u in i.productsData){o=i.productsData[u];break}i.errorType=="invalid_product_quantity"?o.availableQuantity*1>0?p.message=t.l10n.get("cart_product_quantitynotavailable","The selected quantity for [PRODUCTNAME] is not available.\nThe maximum quantity you can add to the cart is [MAXQUANTITY]").replace("[PRODUCTNAME]",o.name).replace("[MAXQUANTITY]",o.availableQuantity):p.message=t.l10n.get("cart_product_notavailable","The product [PRODUCTNAME] is not available now").replace("[PRODUCTNAME]",o.name):p.message="Generic Error"}else p=e.extend(p,{success:!1,message:"Generic Error"});p.success&&n.imStorage.setItem(r.settings.lastOrderCookie,p.orderNo),e.isFunction(s)&&s(p)},error:function(){e.isFunction(s)&&s({success:!1,message:"Generic Error"})}})}},this.orderNumber=function(){return g},this.empty=function(e){e=e===null||e===undefined?!0:e,s=o=c=g=null,i={},E["x5cart.priceChanged"].fire(),E["x5cart.quantityChanged"].fire(),e&&this.save()},this.getStringifiedEncodedData=function(){var e='{ "pData": '+this.getStringifiedOrderData()+', "fData": '+this.getStringifiedFormData()+" }";return"btoa"in n?encodeURIComponent(n.btoa(unescape(encodeURIComponent(e)),w)):encodeURIComponent(t.utils.encrypt2(e,w))},this.getStringifiedFormData=function(){return JSON.stringify({ivc:this.userInvoiceData(),shp:this.userShippingData()})},this.getStringifiedOrderData=function(){var e=[],t={crt:[],shp:null,pay:null,cpn:null,orderNo:null},n=!1;s&&(t.shp=s),o&&(t.pay=o),c&&(t.cpn=c),g&&(t.orderNo=g);for(var r in i){var u=i[r],a={id:u.id(),qnt:u.quantity(),opt:null,sopt:null};u.option()&&(a.opt=u.option(),u.subOption()&&(a.sopt=u.subOption())),t.crt.push(a)}return JSON.stringify(t)},this.save=function(){n.imStorage.setItem(r.settings.cartCookie,this.getStringifiedOrderData()),n.imStorage.setItem(r.settings.formCookie,this.getStringifiedFormData())},this.load=function(u){u=e.extend({pData:null,fData:null,quiet:!1},u);try{var a=u.pData?u.pData:JSON.parse(n.imStorage.getItem(r.settings.cartCookie,null)),f=u.fData?u.fData:JSON.parse(n.imStorage.getItem(r.settings.formCookie,null));if(a){if("crt"in a){i={};for(var l=0;l<a.crt.length;l++){var h=a.crt[l],p,d;r.products[h.id]&&(p=new t.cart.product(r.products[h.id],{quantity:h.qnt*1,option:h.opt,suboption:h.sopt,quiet:u.quiet}),i[p.hash()]=p)}}"shp"in a&&r.shippings[a.shp]?s=a.shp:s=null,"pay"in a&&r.payments[a.pay]?o=a.pay:o=null,"cpn"in a?this.coupon(a.cpn,!1):c=null,"orderNo"in a?g=a.orderNo:g=null,E["x5cart.priceChanged"].fire()}return f&&(v="ivc"in f?f.ivc:{},m="shp"in f?f.shp:{}),!0}catch(y){}return!1},this.bind=function(e,t){return e in E?E[e].has(t)?this:(E[e].add(t),this):this},this.unbind=function(e,t){return e in E?(t?E[e].remove(t):E[e].empty(),this):this},this.restore=function(r){var i=this,s=function(t){if(!t)throw"Empty json string";o=JSON.parse(t);if(typeof o!="object")throw"Wrong json type";return i.empty(!1),i.load(e.extend(o,{quiet:!0}))},o;try{if("atob"in n)return o=decodeURIComponent(escape(n.atob(decodeURIComponent(r)))),s(o)}catch(u){if("console"in n){var a="Safe encrypt "+u;console.log(a,"data:",r,o)}}try{return o=t.utils.decrypt2(r,w),s(o)}catch(u){if("console"in n){var f="Method 2 "+u;console.log(f,"data:",r,o)}}try{return o=t.utils.decrypt(r,b),s(o)}catch(u){if("console"in n){var l="Method 1 "+u;console.log(l,"data:",r,o)}}return!1},this.getLastOrderNumber=function(){return n.imStorage.getItem(r.settings.lastOrderCookie)},this.clearLastOrderNumber=function(){n.imStorage.removeItem(r.settings.lastOrderCookie)},this.load({quiet:!0})}})})(_jq,x5engine,window),function(e,t){"use strict";e.extend(!0,t.cart,{product:function(n,r){var i=e.extend(!0,{id:null,id_user:null,category:null,description:"",price:0,images:[],link:null,vat:0,vattype:"none",physical_delivery:!0,digital_delivery:!1,weight:0,availabilityType:"fixed",staticAvailValue:"unknown",offlineAvailableItems:0,precision:5,options:{},discount:{type:"relative",amount:0,start_date:null,end_date:null,coupon:!1},quantityDiscounts:{},minQuantity:0},n),s=e.extend(!0,{quantity:i.minQuantity>0?i.minQuantity:1,quiet:!1,option:null,suboption:null,postUrl:"cart/x5cart.php",onProductCreated:null},r),o=!1,u=function(e,t){return t[0]===null||t[0]===undefined?0:t[0]};this.hash=function(){return t.utils.imHash(this.id()+(s.option?s.option:"")+(isNaN(s.suboption)?"":s.suboption))},this.base=function(){return e.extend(!0,i,{optionsLength:function(){var e=0;for(var t in i.options)i.options.hasOwnProperty(t)&&e++;return e}})},this.quiet=function(e){return typeof e=="boolean"&&(s.quiet=e),s.quiet},this.id=function(){return i.id},this.setQuantity=function(n){var r=e.Deferred();if(isNaN(n)||!/[0-9]+/.test(n)||parseInt(n,10)<1)return r.reject({name:"Product Quantity",message:t.l10n.get("cart_err_qty")}),r.promise();if(i.minQuantity>n&&!s.quiet)return r.reject({name:"Product Quantity",message:t.l10n.get("cart_err_quantity").replace(/\[QUANTITY\]/g,i.min_quantity)}),r.promise();if(i.availabilityType=="fixed"&&i.staticAvailValue=="notavailable"&&!s.quiet)return r.reject({name:"Product Quantity",message:t.l10n.get("cart_product_notavailable","The product [PRODUCTNAME] is not available now").replace("[PRODUCTNAME]",i.id_user)}),r;if(i.availabilityType=="dynamic"&&!s.quiet)return t.settings.islocal?i.offlineAvailableItems?n>i.offlineAvailableItems?(r.reject({name:"Product Quantity",message:t.l10n.get("cart_product_quantitynotavailable","The selected quantity for [PRODUCTNAME] is not available.\nThe maximum quantity you can add to the cart is [MAXQUANTITY]").replace("[PRODUCTNAME]",i.id_user).replace("[MAXQUANTITY]",i.offlineAvailableItems)}),r):(s.quantity=n,r.resolve(n),r):(r.reject({name:"Product Quantity",message:t.l10n.get("cart_product_notavailable","The product [PRODUCTNAME] is not available now").replace("[PRODUCTNAME]",i.id_user)}),r):(e.ajax({url:t.settings.currentPath+s.postUrl+"?action=productstatus&rand="+Math.round(Math.random()*1e5),type:"POST",data:{product_id:i.id},dataType:"text"}).done(function(e){e*=1;if(!isNaN(e)){if(!e){r.reject({name:"Product Quantity",message:t.l10n.get("cart_product_notavailable","The product [PRODUCTNAME] is not available now").replace("[PRODUCTNAME]",i.id_user)});return}if(n>e){r.reject({name:"Product Quantity",message:t.l10n.get("cart_product_quantitynotavailable","The selected quantity for [PRODUCTNAME] is not available.\nThe maximum quantity you can add to the cart is [MAXQUANTITY]").replace("[PRODUCTNAME]",i.id_user).replace("[MAXQUANTITY]",e)});return}s.quantity=n,r.resolve(n)}}).fail(function(){r.reject({name:"Generic Error",message:"Generic error"})}),r);return s.quantity=n,r.resolve(n),r.promise()},this.quantity=function(e){return s.quantity},this.option=function(e){return e&&e in i.options&&(s.option=e,"suboptions"in i.options[e]&&s.suboption===null&&(s.suboption=0)),s.option},this.subOption=function(e){return e&&s.option in i.options&&e in i.options[s.option].suboptions&&(s.suboption=e),s.suboption},this.discount=function(e){var t=0,n=i.discount,r=0,u=0,a=new Date;a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds());if(!!n.start_date&&n.start_date>a)return 0;if(!!n.end_date&&n.end_date<a)return 0;if(!n.coupon||n.coupon&&o)switch(n.type){case"absolute":t+=n.amount;break;case"relative":t+=this.singleFullPrice(e)*n.amount}for(var f in i.quantityDiscounts)s.quantity>=parseFloat(f,10)&&u<i.quantityDiscounts[f]&&(r=f,u=i.quantityDiscounts[r]);return u&&(t+=(this.singleFullPrice(e)-t)*u),t},this.singleFullPrice=function(e){var t=i.price,n=i.options[this.option()];return n&&"pricevar"in n&&(t+=n.pricevar),(t*(e?1+i.vat:1)).toFixed(i.precision)*1},this.singlePrice=function(e){var t=0;switch(i.vattype){case"excluded":t=(this.singleFullPrice(!1)-this.discount(!1))*(e?1+i.vat:1);break;case"included":t=(this.singleFullPrice(!0)-this.discount(!0))/(e?1:1+i.vat);break;default:t=this.singleFullPrice(!1)-this.discount(!1)}return Math.max(0,t)},this.fullPrice=function(e){return this.singleFullPrice(e)*s.quantity},this.price=function(e){return this.singlePrice(e)*s.quantity},this.singleVat=function(){return this.singlePrice(!1)*i.vat},this.fullVat=function(){return this.fullPrice(!1)*i.vat},this.vat=function(){return this.price(!1)*i.vat},this.weight=function(){var e=i.weight,t=i.options[this.option()];return t&&"weightvar"in t&&(e+=t.weightvar),e*s.quantity},this.enableCoupon=function(e){var n=new Date,r=t.utils.isOnline();return n=new Date(n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate(),n.getUTCHours(),n.getUTCMinutes(),n.getUTCSeconds()),r&&i.discount.coupon===!1?!1:!r&&i.discount.coupon!=e?!1:!!i.discount.start_date&&i.discount.start_date>n?!1:!!i.discount.end_date&&i.discount.end_date<n?!1:(o=!0,!0)},this.disableCoupon=function(){return o=!1,!0};var a=this,f=e.Deferred();this.setQuantity(s.quantity).done(function(){if(s.option===null)for(var e in i.options){a.option(e);break}else a.option(s.option);f.resolve()}).fail(function(e){f.reject(e)}),e.isFunction(s.onProductCreated)&&s.onProductCreated(f,a)}})}(_jq,x5engine),function(e,t){"use strict";e.extend(!0,t.cart,{shipping:function(t){t=e.extend(!0,{id:null,name:"",description:"",precision:5,vat:0,type:"FIXED",price:0,email:"",image:""},t);var n=0,r=0;this.base=function(){return t},this.id=function(){return t.id},this.name=function(){return t.name},this.description=function(){return t.description},this.image=function(){return t.image},this.price=function(e,n,r){var i,s=0,o=0,u,a,f=0;switch(t.type){case"WEIGHT":for(u in t.price)a=parseFloat(u,10),n>=a&&(!s||a>parseFloat(s,10))&&(s=u,isNaN(t.price[s])||(o=t.price[s]));f=o*(e?1+t.vat:1);break;case"AMOUNT":for(u in t.price)a=parseFloat(u,10),r>=a&&(!s||a>parseFloat(s,10))&&(s=u,isNaN(t.price[s])||(o=t.price[s]));f=o*(e?1+t.vat:1);break;default:f=t.price*(e?1+t.vat:1)}return f.toFixed(t.precision)*1},this.vat=function(e,n){return t.vat*this.price(!1,e,n)},this.email=function(){var e=t.email;return e===null||e===undefined||e===""?"":e}}})}(_jq,x5engine),function(e,t){"use strict";e.extend(!0,t.cart,{payment:function(t){t=e.extend(!0,{id:null,name:"",description:"",image:"",email:"",precision:5,vat:0,vattype:"none",pricetype:"fixed",price:0,html:"",emailHtml:""},t),this.base=function(){return t},this.id=function(){return t.id},this.price=function(e,n){if(t.pricetype=="fixed")return(t.price+(n?this.vat(e):0)).toFixed(t.precision)*1;if(t.pricetype=="percentual"){var r;switch(t.vattype){case"included":if(n)return(t.price*e).toFixed(t.precision)*1;return(t.price*e/(1+t.vat)).toFixed(t.precision)*1;case"excluded":return r=t.price*e,n&&(r*=1+t.vat),r.toFixed(t.precision)*1;default:return(t.price*e).toFixed(t.precision)*1}}return 0},this.vat=function(e){return t.vat*this.price(e,!1)},this.name=function(){return t.name},this.description=function(){return t.description},this.html=function(){var e=t.html;return e?e:""},this.emailHtml=function(){var e=t.emailHtml;return e?e:""},this.email=function(){var e=t.email;return e===null||e===undefined||e===""?"":e},this.image=function(){return t.image}}})}(_jq,x5engine),function(e,t,n){"use strict";e.extend(!0,t.cart.ui,{getWindow:function(){try{var e=n.top.location.href;return n.top}catch(t){return n}},show:function(){var r=e("#cartLoading"),i=e("#imCartContainer"),s=t.cart.manager,o=t.cart.ui.getWindow(),u=s.settings(),a=u.vattype,f=a=="included",l=t.cart.ui.iconSize,c=t.cart.ui.showProductIcons,h=e.Deferred().resolve().promise(),p=t.l10n.get,d='<h2 style="text-align: center">'+p("cart_err_emptycart","The cart is empty")+"</h2>"+'<div style="text-align: center; margin-top: 20px;"><input type="button" value="'+p("cart_continue_shopping","Continue shopping")+'" /></div>',v=function(e,t,n,r,i,o,u){var f="";r=r&&r!==1?' colspan="'+(a!="none"?r:r-2)+'"':"",o=o!==null&&o!==undefined?o:!1;switch(a){case"excluded":f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head">'+p("cart_total")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(t).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_vat")+"</td>"+'<td class="text-right" colspan="2" style="width:'+i+'%">'+s.formatCurrency(n).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>",o&&s.coupon()!==""?(f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_total_vat")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(e).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>",s.cartDiscount()>0?f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">('+s.coupon()+") -"+s.formatCurrency(s.cartDiscount()).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+r+' class="invisible"></td>'+'<td class="head dynamic-width" style="border-bottom: none;">'+p("cart_grand_total","Grand total")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(u).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>":f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">'+s.coupon().replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"):f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width" style="border-bottom: none;">'+p("cart_total_vat")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(e).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>";break;case"included":f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_total_vat")+"</td>"+'<td class="text-right" colspan="2" style="width:'+i+'%">'+s.formatCurrency(e).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>",o&&s.coupon()!==""?(f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head">'+p("cart_vat_included","VAT (Included)")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(n).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>",s.cartDiscount()>0?f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">('+s.coupon()+") -"+s.formatCurrency(s.cartDiscount()).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+r+' class="invisible"></td>'+'<td class="head dynamic-width" style="border-bottom: none;">'+p("cart_grand_total","Grand total")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(u).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>":f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">'+s.coupon().replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"):f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head" style="border-bottom: none;">'+p("cart_vat_included","VAT (Included)")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(n).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>";break;case"none":o&&s.coupon()!==""?(f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_total")+"</td>"+'<td class="text-right" colspan="2" style="width:'+i+'%">'+s.formatCurrency(t).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>",s.cartDiscount()>0?f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">('+s.coupon()+") -"+s.formatCurrency(s.cartDiscount()).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"+'<tr class="vertical-middle">'+"<td"+r+' class="invisible"></td>'+'<td class="head dynamic-width" style="border-bottom: none;">'+
p("cart_grand_total","Grand total")+"</td>"+'<td class="text-right" colspan="2">'+s.formatCurrency(u).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>":f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width">'+p("cart_coupon_code","Coupon Code")+"</td>"+'<td class="text-right" colspan="2">'+s.coupon().replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"):f+='<tr class="vertical-middle"><td'+r+' class="invisible"></td>'+'<td class="head dynamic-width" style="border-bottom: none;">'+p("cart_total")+"</td>"+'<td class="text-right" colspan="2" style="width:'+i+'%">'+s.formatCurrency(t).replace(/\s/g,"&nbsp;")+"</td>"+"</tr>"}return f},m=function(){var t=e("#imContent");e("#imCartContainer img").one("load",function(){t.trigger("change")}),t.trigger("change")},g=function(n){var r="",o=s.category(n),u,h,d,v=!1,g=!1,y=0;e(".imTip").remove(),i.empty();for(d in o)if(o[d].base().optionsLength()>0){v=!0;break}i.append('<h2 id="imPgTitle" class="imTitleMargin">'+p("cart_category")+"</h2>").append("<p>"+p("cart_step1_descr")+"</p>"),r+='<table class="cartTable"><thead><tr><td class="first-x">'+p("cart_descr")+"</td>"+(v?"<td>"+p("cart_opt")+"</td>":"")+"<td>"+p("cart_price")+"</td>"+(a!=="none"?"<td>"+p("cart_vat")+"</td>":"")+"<td>"+p("cart_qty")+"</td>"+'<td class="last-x"></td>'+"</tr>"+"</thead>"+"<tbody>";for(d in o){u=o[d],r+="<tr><td>"+(c&&u.base().images.length?'<img src="../'+u.base().images[0]+'" alt="'+u.base().name+'" style="float: left; margin: 5px 5px 5px 0; width: '+l+'px;" />':"")+"<b>"+u.base().name+"</b><p>"+u.base().description+"</p></td>"+"</td>";if(v){g=null,r+="<td>";if(u.base().optionsLength()>0){r+='<select data-hash="'+d+'" data-type="option" id="opt-'+d+'">';for(var b in u.base().options)g===null&&(g="suboptions"in u.base().options[b]&&u.base().options[b].suboptions.length>0?b:!1),r+='<option value="'+b+'">'+u.base().options[b].name+"</option>";r+="</select>";if(g){var w=u.base().options[g].suboptions;r+='<select data-hash="'+d+'" id="subopt-'+d+'">';for(var E=0;E<w.length;E++)r+='<option value="'+E+'">'+w[E]+"</option>";r+="</select>"}}r+="</td>"}r+='<td id="price-'+d+'">'+s.formatCurrency(u.singlePrice(f))+"</td>"+(a!=="none"?'<td id="vat-'+d+'">'+s.formatCurrency(u.vat())+"</td>":"")+"<td>"+'<input size="2" type="text" value="'+u.quantity()+'" id="qty-'+d+'" class="text-right">'+"</td>"+'<td style="vertical-align: middle; text-align: center;">'+'<img src="../'+s.settings().add_to_cart_icon+'" data-type="add" data-hash="'+d+'" style="cursor: pointer;">'+"</td>"+"</tr>"}r+="</tbody></table>",r=e(r),r.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),r.find("tr").each(function(){var t=e(this).find("td");t.first().addClass("first-x"),t.last().addClass("last-x")}),r.find("tr").last().find("td").addClass("last-y"),r.find("select[data-type=option]").on("change",function(){var t=e(this),n=t.attr("data-hash"),r=null;if(n&&(r=o[n])){var i,u=t.val();e("#subopt-"+n).remove();if("suboptions"in r.base().options[u]&&r.base().options[u].suboptions.length>0){i='<select id="subopt-'+n+'">';for(var l=0;l<r.base().options[u].suboptions.length;l++)i+='<option value="'+r.base().options[u].suboptions[l]+'">'+r.base().options[u].suboptions[l]+"</option>";i+="</select>",t.after(i)}t.attr("data-type")=="option"?o[n].option(t.val()):t.attr("data-type")=="suboption"&&o[n].subOption(t.val()),e("#price-"+n).html(s.formatCurrency(o[n].singlePrice(f))),a!="none"&&e("#vat-"+n).html(s.formatCurrency(o[n].singleVat()))}return!1}),r.find("img[data-type=add]").on("click",function(){var n=e(this),r=n.attr("data-hash");t.cart.ui.addToCart(o[r].id(),e("#qty-"+r).val(),e("#opt-"+r).val(),e("#subopt-"+r).val(),!0,"../")}),i.append(r),m()},y=function(){var r=null,h=null,g=null,b=null,w=null,E=null,S=null,x=function(){var t=s.cart(),o,h,d=!1,m=!1,g="",b="";for(g in t)if(t[g].option()!==null){d=!0;break}b='<div><table class="cartTable" cellpadding="0" cellspacing="0" border="0" style="margin-bottom: 0;"><thead><tr><td>'+p("cart_descr")+(d?" / "+p("cart_opt"):"")+"</td>"+'<td class="min-width mobile-hide">'+p("cart_price")+"</td>"+'<td style="width: 6%;">'+p("cart_qty")+"</td>"+(a!="none"?'<td class="dynamic-width mobile-hide">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td style="width: 10%;" class="min-width mobile-hide">'+p("cart_subtot")+"</td>"+'<td style="width: 6%; text-align: center;"></td>'+"</tr></thead><tbody>";for(g in t){o=t[g];if(o){h=o.base().options,m=!1,b+='<tr><td class="mobile-65-5"><p style="display: block;">'+(c&&o.base().images.length?'<img src="../'+o.base().images[0]+'" alt="'+o.base().name+'" style="margin: 5px 5px 5px 0; width: '+l+'px; vertical-align: middle;" />':"")+"<b>"+o.base().name+"</b>"+"</p>";if(d&&o.base().optionsLength()>0){b+='<p style="display: block;"><select data-type="option" data-hash="'+g+'" style="margin-right: 5px;">';for(var w in h)b+='<option value="'+w+'"'+(o.option()==w?" selected":"")+">"+h[w].name+"</option>",o.option()==w&&(m=typeof o.base().options[w].suboptions=="object");b+="</select>";if(m){var E=o.base().options[o.option()].suboptions;b+='<select data-type="suboption" data-hash="'+g+'">';for(var S=0;S<E.length;S++)b+='<option value="'+S+'"'+(S==o.subOption()?" selected":"")+">"+E[S]+"</option>";b+="</select>"}b+="</p>"}b+='<p style="display: block; font-size: 0.85em;">'+o.base().description+"</p>",b+='<p class="mobile-show mobile-small"><b>'+p("cart_price")+"</b>: "+s.formatCurrency(o.singlePrice(f)).replace(/\s/g,"&nbsp;")+"</p>",a!="none"&&(b+='<p class="mobile-show mobile-small"><b>'+(f?p("cart_vat_included"):p("cart_vat"))+"</b>: "+s.formatCurrency(o.vat()).replace(/\s/g,"&nbsp;")+" ("+Number(o.base().vat*100).toFixed(2)+"%)"),b+='<p class="mobile-show mobile-small"><b>'+p("cart_subtot")+"</b>: "+s.formatCurrency(o.price(f)).replace(/\s/g,"&nbsp;")+"</p>",b+="</td>",b+='<td class="text-right mobile-hide">'+s.formatCurrency(o.singlePrice(f)).replace(/\s/g,"&nbsp;")+(o.discount()>0?'<span style="text-decoration: line-through; margin-left: 5px;">'+s.formatCurrency(o.singleFullPrice(f)).replace(/\s/g,"&nbsp;")+"</span>":"")+"</td>"+'<td class="text-right"><input data-hash="'+g+'" type="number" min="1" value="'+o.quantity()+'""></td>'+(a!="none"?'<td class="text-right mobile-hide">'+(s.formatCurrency(o.vat())+" ("+Number(o.base().vat*100).toFixed(2)+"%)").replace(/\s/g,"&nbsp;")+"</td>":"")+'<td class="text-right mobile-hide">'+s.formatCurrency(o.price(f)).replace(/\s/g,"&nbsp;")+"</td>"+'<td style="text-align: center;"><img data-hash="'+g+'" data-action="delete" style="vertical-align: middle; cursor: pointer;" src="../'+u.remove_from_cart_icon+'" alt="'+p("cart_remove")+'" title="'+p("cart_remove")+'" /></td>'+"</tr>"}}b+="</tbody></table>";if(s.shippingsCount()>0||s.paymentsCount()>0)b+='<table class="cartTable priceTable" cellpadding="0" cellspacing="0" border="0" style="margin-top: 0;"><tbody>'+v(s.goodsPrice(!0),s.goodsPrice(!1),s.goodsVat(),d?1:2,16)+"</tbody>"+"</table></div>";b=e(b),b.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),b.find("table").each(function(t){var n=e(this).find("tr");n.each(function(r){var i=e(this).find("td").not(".invisible");i.first().addClass("first-x"),i.last().addClass("last-x"),t===0&&r==n.length-1&&i.last().css("border-radius",0),t==1&&r===0&&i.css({"border-top-left-radius":0,"border-top-right-radius":0,"border-top-color":"transparent"})}),n.last().find("td").not(".invisible").addClass("last-y")}),b.find("select").on("change",function(){var t=e(this),r=t.attr("data-hash"),i=null;if(r&&(i=s.cart()[r])){var o,u;t.attr("data-type")=="option"?(o=t.val(),u=i.base().options[o].suboptions?0:null):(o=i.option(),u=t.val()),s.update(r,i.quantity()*1,o,u).always(function(){x(),N(),T(),C()}).fail(function(e){n.alert(e.message)})}return!1}),b.find("img[data-action=delete]").on("click",function(){var t=e(this).attr("data-hash");if(n.confirm(p("cart_remove_q"))&&t&&s.remove(t)){if(s.count()===0){y();return}x(),N(),T(),C()}return!1}),b.find("input").on("change",function(){var r=e(this),i=e(this).attr("data-hash"),o=r.val();return t[i]&&s.update(i,o,t[i].option(),t[i].subOption()).always(function(){x(),N(),T(),C()}).fail(function(e){n.alert(e.message)}),!1}),r===null?i.append(b):r.replaceWith(b),r=b},T=function(){var t=s.allowedShippings(),n=s.shipping(),r="";if(!s.allowedShippingsCount()){!h||h.remove();return}r='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td style="width: 20px"></td><td>'+p("cart_shipping")+"</td>"+(a!="none"?'<td class="dynamic-width">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td style="width: '+(a!="none"?16:22)+'%;">'+p("cart_price")+"</td>"+"</tr></thead><tbody>";for(var o in t)r+='<tr><td><input type="radio" id="chk-shipping-'+o+'" name="shipping-method" data-id="'+o+'"'+(n&&n.id()==o?" checked":"")+"></td>"+"<td>"+(t[o].image()?'<img src="../'+t[o].image()+'" alt="'+t[o].name()+'" style="float: left; margin: 5px 5px 5px 0;"/>':"")+'<label for="chk-shipping-'+o+'"><b>'+t[o].name()+"</b><p>"+t[o].description()+"</p></label></td>"+(a!="none"?'<td class="text-right">'+s.formatCurrency(t[o].vat(s.goodsWeight(),s.goodsPrice(f)))+" ("+Number(t[o].base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+s.formatCurrency(t[o].price(f,s.goodsWeight(),s.goodsPrice(f)))+"</td>"+"</tr>";r+="</tbody></table>",r=e(r),r.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),r.find("tr").each(function(){var t=e(this).find("td").not(".invisible");t.first().addClass("first-x"),t.last().addClass("last-x")}),r.find("tr").last().find("td").not(".invisible").addClass("last-y"),r.find("input[type=radio]").on("click",function(){var t=e(this).attr("data-id");t&&(s.shipping(t),N(),C())}),h===null?i.append(r):h.replaceWith(r),h=r},N=function(){var t=s.payments(),n=s.payment(),r="";if(s.paymentsCount()===0)return;r='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td style="width: 20px"></td><td>'+p("cart_payment")+"</td>"+(a!="none"?'<td class="dynamic-width">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td style="width: '+(a!="none"?16:22)+'%;">'+p("cart_price")+"</td>"+"</tr></thead><tbody>";for(var o in t)r+='<tr><td><input type="radio" id="chk-payment-'+o+'" name="payment-method" data-id="'+o+'"'+(n&&n.id()==o?" checked":"")+"></td>"+"<td>"+(t[o].image()?'<img src="../'+t[o].image()+'" alt="'+t[o].name()+'" style="float: left; margin: 5px 5px 5px 0;"/>':"")+'<label for="chk-payment-'+o+'"><b>'+t[o].name()+"</b><p>"+t[o].description()+"</p></label></td>"+(a!="none"?'<td class="text-right">'+s.formatCurrency(s.paymentVat(o,!1))+" ("+Number(t[o].base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+s.formatCurrency(s.paymentPrice(o,f,!1))+"</td>"+"</tr>";r+="</tbody></table>",r=e(r),r.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),r.find("tr").each(function(){var t=e(this).find("td").not(".invisible");t.first().addClass("first-x"),t.last().addClass("last-x")}),r.find("tr").last().find("td").not(".invisible").addClass("last-y"),r.find("input").on("click",function(){var t=e(this).attr("data-id");t&&(s.payment(t),C())}),g===null?i.append(r):g.replaceWith(r),g=r},C=function(){var t,n='<table cellpadding="0" cellspacing="0" border="0" class="cartTable priceTable"><tbody>'+v(s.price(!0),s.price(!1),s.vat(),null,16,!0,s.price(!0,!0))+"</tbody>"+"</table>";n=e(n),n.find("tbody > tr:odd > td").not(".invisible").addClass("odd"),t=n.find("tr"),t.each(function(){var t=e(this).find("td").not(".invisible");t.first().addClass("first-x"),t.last().addClass("last-x")}),t.first().find("td").not(".invisible").addClass("first-y"),t.last().find("td").not(".invisible").addClass("last-y"),b===null?i.append(n):b.replaceWith(n),b=n};e(".imTip").remove(),t.utils.scrollTo(0),i.empty();if(s.count()===0){i.append(d),i.find("[type=button]").on("click",t.cart.ui.resumeShopping);return}t.cart.ui.steps.active&&i.append(t.cart.ui.getStepStyleDom(0)),i.append('<h2 id="imPgTitle" class="imTitleMargin">'+p("cart_step1")+"</h2>"),i.append("<p>"+p("cart_step1_cartlist").replace("[FIELD]",p("cart_step1_gonext"))+"</p>"),x(),(s.allowedShippingsCount()>0||s.paymentsCount()>0)&&i.append("<p>"+p("cart_step1_shiplist").replace("[FIELD]",p("cart_step1_gonext"))+"</p>"),T(),N(),C(),s.canApplyCoupon()&&i.append(e("<div />").html("<b>"+p("cart_coupon_code","Coupon Code")+"</b>"+"<p>"+p("cart_coupon_description","Apply your coupon code here!")+"</p>"+'<input type="text" id="x5CouponCode" value="'+s.coupon()+'">').css({clear:"both","margin-left":"5%","margin-bottom":20}).append(e('<input type="button" style="margin: 0 5px 0 5px;" id="x5ApplyCouponCode" value="'+p("cart_apply","Apply")+'" />').on("click",function(){var t=e("#x5CouponCode").val(),n=e(this),r=n.val();t.length&&(n.val(p("cart_loading","Loading...")),s.coupon(t,!0,function(t){var i=e("<span />").text(t!==""?p("cart_coupon_enabled","The coupon is active"):p("cart_coupon_disabled","The coupon is not active")).addClass("alert").addClass(t!==""?"alert-green":"alert-red").fadeOut(0);n.siblings(".alert").stop(!1,!1).remove(),n.after(i),i.fadeIn().delay(1e4).fadeOut(250,function(){e(this).remove()}),x(),T(),N(),C(),e("#x5CouponCode").val(t),n.val(r),m()}))}))),E=e('<input type="button" value="'+p("cart_continue_shopping")+'" />').on("click",t.cart.ui.resumeShopping),S=e('<input type="button" id="btnempty" value="'+p("cart_empty_button")+'" />').on("click",function(){if(n.confirm(p("cart_empty"))){var r=e("#imContent"),i=e("#imContentGraphics");t.utils.scrollTo(0),s.empty(),t.cart.ui.show("step1"),r.height(0),i.length>0&&!!i.css("min-height")&&r.css("min-height",i.css("min-height")),m()}}),w=e('<input type="button" id="btngonext" value="'+p("cart_step1_gonext",p("cart_gonext"))+'" />').on("click",function(){var e=s.canSetOrder();e.success!==!0?n.alert(e.message):o.location.hash="#step2"}),i.append(e("<div />").addClass("buttons-container").append(E).append(S).append(w)),m(),!!g&&g.find("input[type=radio]").length==1&&g.find("input[type=radio]").trigger("click"),!!h&&h.find("input[type=radio]").length==1&&h.find("input[type=radio]").trigger("click")},b=function(r,a){var f=null,l=null,c,d,v=e('<table class="userForm"/>'),g=e('<table class="userForm"/>'),y=s.form().fields,b,w,E;if(!s.canSetOrder().success){o.location.hash="#step1";return}s.updateUserData().fail(function(){s.userInvoiceData([]),s.userShippingData([]),n.top.location="../"+s.settings().loginpage+"?landing_page="+encodeURIComponent(s.settings().indexpage+"?#step2skip3")+"&redirect_after_registration=true&cart=true"}).done(function(){if(a==1){n.top.location.hash="#step3";return}c=s.userInvoiceData(),d=s.userShippingData(),e(".imTip").remove(),t.utils.scrollTo(0),i.empty(),t.cart.ui.steps.active&&i.append(t.cart.ui.getStepStyleDom(1)),i.append('<h2 id="imPgTitle" class="imTitleMargin">'+p("cart_step2")+"</h2>").append("<p>"+p("cart_step2_descr").replace("[FIELD]",p("cart_step2_gonext"))+"</p>"),v.append("<caption>"+p("cart_vat_address")+"</caption>");var o=function(e,n,r){var i="",s;r?s=u.formAutocomplete&&d[e.id]?d[e.id].value:e.value?e.value:"":s=u.formAutocomplete&&c[e.id]?c[e.id].value:e.value?e.value:"";switch(e.type){case"TextArea":i='<textarea id="'+n+e.id+'" class="'+e.filter+'" data-uuid="'+n+e.uuid+'">'+s+"</textarea>";break;case"DropDownList":i='<select id="'+n+e.id+'" class="'+e.filter+'" data-uuid="'+n+e.uuid+'">';for(T=0;T<e.value.length;T++)x=e.value[T].text==s||e.value[T].value==s?" selected":"",i+='<option value="'+e.value[T].value+'"'+x+">"+e.value[T].text+"</option>";i+="</select>";break;case"Attachment":i='<input type="File" id="'+n+e.id+'" value="'+s+'" class="'+e.filter+'" data-uuid="'+n+e.uuid+'">';break;case"Telephone":i='<input type="tel" id="'+n+e.id+'" value="'+s+'" class="'+e.filter+'" data-uuid="'+n+e.uuid+'">';break;default:var o=!1;e.id=="Email"&&u.registerUsers===1&&(t.utils.isValidEmail(s)?o=!0:s=""),i="<input "+(o?"readonly":"")+' type="'+e.type+'" id="'+n+e.id+'" value="'+s+'" class="'+e.filter+'" data-uuid="'+n+e.uuid+'">'}return i='<tr style="vertical-align: middle;"><td style="width: 35%"><label for="'+n+e.id+'">'+e.name+(e.mandatory?"*":"")+" </label></td>"+"<td>"+i+"</td>"+"</td>",i},b=function(e,t,n){e.on("change","select",function(){for(w=0;w<y.length;w++){if(n&&!y[w].shipping)continue;if(!y[w].isVisible(t)){e.find("[data-uuid="+t+y[w].uuid+"]").parents("tr").remove();continue}if(!e.find("[data-uuid="+t+y[w].uuid+"]").length){var r=0;for(var i=0;i<y.length&&i<w;i++)y[i].isVisible(t)&&(!n||y[w].shipping)&&r++;e.find("select, input").eq(r).parents("tr").before(o(y[w],t,n))}}}).find("select:first").trigger("change")},S,x,T;for(w=0;w<y.length;w++)E=y[w],S=o(E,"",!1),v.append(S);i.append(v.css("margin","0 auto")),b(v,"",!1);var N=v.find("input").first();N.length&&N.val().length===0&&N.focus();if(u.showShipmentFields){var C=!1;g.append("<caption>"+p("cart_shipping_address")+"</caption>");for(w=0;w<y.length;w++)E=y[w],E.shipping&&(C=C||!!d[E.id],S=o(E,"shipping-",!0),g.append(S));i.append(e('<div id="shippingForm" />').css({"text-align":"center",margin:"5px 0"}).append(e('<input type="checkbox" id="chk-shipping"'+(C?" checked":"")+" />").on("change",function(){e(this).prop("checked")?e("#shippingFormWrapper").slideDown(250,function(){e("#imContent").triggerHandler("change")}):e("#shippingFormWrapper").slideUp(250,function(){e("#imContent").triggerHandler("change")})})).append(e('<label for="chk-shipping">'+p("cart_shipping_option")+"</label>"))).append(g),b(g,"shipping-",!0),g.css("margin","20px auto").wrap('<div id="shippingFormWrapper">'),C||e("#shippingFormWrapper").slideUp(0)}f=e('<input type="button" value="'+p("cart_step2_gonext",p("cart_gonext"))+'" />').on("click",function(){var r=t.imForm.validate,i={type:u.formValidation,showAll:!0,position:"right"};c={};for(w=0;w<y.length;w++)if(y[w].id=="Country")c[y[w].id+"Code"]={label:y[w].name+" (ISO 3166/A2)",value:e("#"+y[w].id).val().toUpperCase()},c[y[w].id]={label:y[w].name,value:e("#"+y[w].id+" :selected").text()};else if(y[w].id=="Attachment"){var o=y[w].id,a=y[w].name,f=e("#Attachment")[0].files[0];if(typeof f!="undefined"){var l=new FormData;l.append("attachment",f);var p=function(n,r){var i=u.post_url;return i+=i.indexOf("?")==-1?"?":"&",c[n]={label:r,value:e("#"+y[w].id).val().replace(/^.*[\\\/]/,"")},t.utils.isOnline()?e.ajax({url:t.settings.currentPath+i+"action=uploadattachment&"+Math.round(Math.random()*1e4),type:"POST",dataType:"json",data:l,contentType:!1,cache:!1,processData:!1}).done(function(e){e.status=="ok"&&(c[n]={label:r,value:e.fileName})}):e.Deferred().resolve().promise()};h=p(o,a)}else c[y[w].id]={label:y[w].name,value:""}}else c[y[w].id]={label:y[w].name,value:t.utils.htmlspecialchars(e("#"+y[w].id).val())};s.userInvoiceData(c),d={};if(u.showShipmentFields&&e("#chk-shipping").prop("checked"))for(w=0;w<y.length;w++){if(!y[w].shipping)continue;y[w].id=="Country"?(d[y[w].id+"Code"]={label:y[w].name+" (ISO 3166/A2)",value:e("#shipping-"+y[w].id).val().toUpperCase()},d[y[w].id]={label:y[w].name,value:e("#shipping-"+y[w].id+" :selected").text()}):d[y[w].id]={label:y[w].name,value:t.utils.htmlspecialchars(e("#shipping-"+y[w].id).val())}}s.userShippingData(d),r(v,i)&&(!u.showShipmentFields||!e("#chk-shipping").prop("checked")||e("#chk-shipping").prop("checked")&&r(g,i))&&(n.top.location.hash="#step3")}),l=e('<input type="button" value="'+p("cart_step2_goback",p("cart_goback"))+'" />').on("click",function(){n.top.location.hash="#step1"}),i.append(e("<div />").addClass("buttons-container").append(l).append(f)),m(),r&&t.utils.scrollTo("#"+r)})},w=function(){var r=null,l=null,c=s.cart(),d=s.shipping(),g=s.payment(),y=s.userInvoiceData(),b=s.userShippingData(),w=s.form().agreement,E=null,S=null,x=null,T=null,N,C=!1,k="";if(!s.canSetOrder().success){o.location.hash="#step1";return}if(!s.isSetUserData()){o.location.hash="#step2";return}e(".imTip").remove(),t.utils.scrollTo(0);for(N in c)if(c[N].option()!==null){C=!0;break}i.empty(),t.cart.ui.steps.active&&i.append(t.cart.ui.getStepStyleDom(2)),i.append('<h2 id="imPgTitle" class="imTitleMargin">'+p("cart_step3")+"</h2>").append("<p>"+p("cart_step3_descr").replace("[FIELD]",p("cart_step3_gonext"))+"</p>"),k+='<div><table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+(!u.showShipmentFields||u.showShipmentFields&&JSON.stringify(b)!="{}"?p("cart_vat_address"):p("cart_vat_address")+" / "+p("cart_shipping_address"))+"</td>"+(u.showShipmentFields&&JSON.stringify(b)!="{}"?'<td style="width: 4%;" class="invisible"></td><td style="width: 48%;">'+p("cart_shipping_address")+"</td>":"")+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td>"+"<p>"+("Company"in y?y.Company.value+" - ":"")+("Name"in y?y.Name.value+" ":"")+("LastName"in y?y.LastName.value:"")+" "+("Email"in y?"("+y.Email.value+")":"")+"<br />"+("Address1"in y?y.Address1.value+"<br />":"")+("Address2"in y?y.Address2.value+"<br />":"")+("ZipPostalCode"in y?y.ZipPostalCode.value+", ":"")+("City"in y?y.City.value:"")+("StateRegion"in y?" ("+y.StateRegion.value+")":"")+("Country"in y&&y.Country.value?"<br />"+y.Country.value:"")+("Phone"in y&&y.Phone.value?"<br />"+y.Phone.value:"")+("Attachment"in y&&y.Attachment.value?"<br /><u>"+y.Attachment.label+":</u> "+y.Attachment.value:"")+("Note"in y&&y.Note.value!==""?"<br /><u>"+y.Note.label+":</u> "+y.Note.value:"")+"</p>"+'<p style="text-align: right;"><a href="#step2" class="button">'+p("cart_edit","Edit")+"</a></p>"+"</td>"+(u.showShipmentFields&&JSON.stringify(b)!="{}"?'<td class="invisible"></td><td><p>'+("Company"in b?b.Company.value+" - ":"")+("Name"in b?b.Name.value+" ":"")+("LastName"in b?b.LastName.value:"")+" "+("Email"in b?"("+b.Email.value+")":"")+"<br />"+("Address1"in b?b.Address1.value+"<br />":"")+("Address2"in b?b.Address2.value+"<br />":"")+("ZipPostalCode"in b?b.ZipPostalCode.value+", ":"")+("City"in b?b.City.value:"")+("StateRegion"in b?" ("+b.StateRegion.value+")":"")+("Country"in b&&b.Country.value?"<br />"+b.Country.value:"")+("Phone"in b&&b.Phone.value?"<br />"+b.Phone.value:"")+("Note"in b&&b.Note.value!==""?"<br /><u>"+b.Note.label+":</u> "+b.Note.value:"")+"</p>"+'<p style="text-align: right;"><a href="#step2/shippingForm" class="button">'+p("cart_edit","Edit")+"</a></p>"+"</td>":"")+"</tr>"+"</tbody>"+"</table>",k+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable" style="margin-bottom: 0"><thead><tr><td>'+p("cart_descr")+"</td>"+(C?'<td clss="min-width-small">'+p("cart_opt")+"</td>":"")+'<td class="min-width-small mobile-hide">'+p("cart_price")+"</td>"+'<td class="mobile-hide">'+p("cart_qty")+"</td>"+(a!="none"?'<td class="dynamic-width mobile-hide">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td class="dynamic-width">'+p("cart_subtot")+"</td>"+"</tr></thead><tbody>";for(N in c)S=c[N],S&&(x=S.base().options,T=S.option(),k+='<tr><td class="mobile-61-5"><b>'+S.base().name+"</b><p>"+S.base().description+"</p>"+'<p class="mobile-show mobile-small"><b>'+p("cart_price")+"</b>: "+s.formatCurrency(S.singlePrice(f)).replace(/\s/g,"&nbsp;")+"</p>"+(a!="none"?'<p class="mobile-show mobile-small"><b>'+(f?p("cart_vat_included"):p("cart_vat"))+"</b>: "+s.formatCurrency(S.vat()).replace(/\s/g,"&nbsp;")+" ("+Number(S.base().vat*100).toFixed(2)+"%)":"")+'<p class="mobile-show mobile-small"><b>'+p("cart_qty")+"</b>: "+S.quantity()+"</p>"+"</td>"+(C?"<td>"+(T&&x[T]?x[T].name:"")+(T&&x[T]&&S.subOption()?" "+x[T].suboptions[S.subOption()]:"")+"</td>":"")+'<td class="text-right mobile-hide">'+s.formatCurrency(S.singlePrice(f)).replace(/\s/g,"&nbsp;")+(S.discount()>0?'<span style="text-decoration: line-through; margin-left: 5px;">'+s.formatCurrency(S.singleFullPrice(f)).replace(/\s/g,"&nbsp;")+"</span>":"")+"</td>"+'<td class="text-right mobile-hide">'+S.quantity()+"</td>"+(a!="none"?'<td class="text-right mobile-hide">'+s.formatCurrency(S.vat())+" ("+Number(S.base().vat*100).toFixed(2)+"%)"+"</td>":"")+'<td class="text-right">'+s.formatCurrency(S.price(f))+"</td>"+"</tr>");k+="</tbody></table>";if(!!d||!!g)k+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable" style="margin-top: 0;"><tbody>'+v(s.goodsPrice(!0),s.goodsPrice(!1),s.goodsVat(),C?4:3,15)+"</tbody>"+"</table>";d&&(k+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+p("cart_shipping")+"</td>"+(a!="none"?'<td class="dynamic-width">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td class="dynamic-width text-right">'+p("cart_price")+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td>"+"<b>"+d.name()+"</b>"+"<p>"+d.description()+"</p>"+"</td>"+(a!="none"?'<td class="text-right">'+s.formatCurrency(d.vat(s.goodsWeight(),s.goodsPrice(f)))+"</td>":"")+'<td class="text-right">'+s.formatCurrency(d.price(f,s.goodsWeight(),s.goodsPrice(f)))+"</td>"+"</tr>"+"</tbody>"+"</table>"),g&&(k+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><thead><tr><td>'+p("cart_payment")+"</td>"+(a!="none"?'<td class="dynamic-width">'+(f?p("cart_vat_included"):p("cart_vat"))+"</td>":"")+'<td class="text-right dynamic-width">'+p("cart_price")+"</td>"+"</tr>"+"</thead>"+"<tbody>"+"<tr>"+"<td><b>"+g.name()+"</b><p>"+g.description()+"</p></td>"+(a!="none"?'<td class="dynamic-width text-right">'+s.formatCurrency(s.paymentVat())+"</td>":"")+'<td class="dynamic-width text-right">'+s.formatCurrency(s.paymentPrice(null,f))+"</td>"+"</tr>"+"</tbody>"+"</table>"),k+='<table cellpadding="0" cellspacing="0" border="0" class="cartTable"><tbody>'+v(s.price(!0),s.price(!1),s.vat(),null,15,!0,s.price(!0,!0))+"</tbody>"+"</table>",k+="</div>",k=e(k),i.append(k),k.find("table").each(function(t){var n=e(this).find("tr");e(this).find("tbody > tr:odd > td").not(".invisible").addClass("odd"),n.each(function(r){var i=e(this).find("td").not(".invisible");i.first().addClass("first-x"),i.last().addClass("last-x"),t===0&&i.addClass("first-x").addClass("last-x"),t==1&&r==n.length-1&&i.last().css("border-radius",0),(!!d||!!g)&&t==2&&r===0&&i.css({"border-top-right-radius":0,"border-top-left-radius":0,"border-top-color":"transparent"})}),n.first().find("td").not(".invisible").addClass("first-y"),n.last().find("td").not(".invisible").addClass("last-y")}),s.form().acceptAgreement&&(w=e('<div id="agreement-text" />').append(w),i.append(w),s.form().acceptAgreement&&(E=e('<div style="margin-bottom: 10px;" />').append('<input id="chk-agreement" type="checkbox" class="mandatory"><label for="chk-agreement">'+p("cart_agree","I Agree")+"</label>"),w.prepend(E))),r=e('<input type="button" value="'+p("cart_step3_gonext",p("cart_gonext"))+'" />').on("click",function(){var r=s.canSetOrder(),i=e(this),u=i.attr("value");if(s.form().acceptAgreement&&!t.imForm.validate(w))return!1;r.success!==!0?n.alert(r.message):(i.attr("value",p("cart_order_process")).off("click"),l.off("click").hide(),h.done(function(e){typeof e=="undefined"||e.status=="ok"?s.setOrder(function(e){e.success?o.location.hash="#step4":(i.attr("value",u),n.alert(e.message))}):n.alert(p("cart_err_attachment_generic"))}).fail(function(e){n.alert(p("cart_err_attachment_generic"))}))}),l=e('<input type="button" value="'+p("cart_step3_goback",p("cart_goback"))+'" />').on("click",function(){o.location.hash="#step2"}),i.append(e("<div />").addClass("buttons-container").append(l).append(r)),m()},E=function(r){r=typeof r=="undefined"?!0:r;var u=s.payment(),a=s.paymentHTML();if(!!r){if(!s.canSetOrder().success){o.location.hash="#step1";return}if(!s.isSetUserData()){o.location.hash="#step2";return}if(!s.orderNumber()){o.location.hash="#step3";return}}e(".imTip").remove(),t.utils.scrollTo(0),i.empty(),t.cart.ui.steps.active&&i.append(t.cart.ui.getStepStyleDom(3)),i.append('<h2 id="imPgTitle" class="imTitleMargin">'+p("cart_step4")+"</h2>").append("<p>"+p("cart_step4_descr")+"</p>").append('<div class="order-number">'+s.orderNumber()+"</div>"),u&&i.append("<p><b>"+u.name()+"</b><br />"+u.email()+"</p>"+(a!==""?'<div id="payment-html">'+a+"</div>":"")),t.utils.isOnline()||t.utils.showOfflineMessage(p("cart_err_offline_email").replace(/\[MAIL\]/g,s.userInvoiceData().Email.value)),e(n).one("hashchange beforeunload",function(){s.empty(!0)}),m()};(function S(t){t||(t=!1);if(t){r.fadeOut(250,S);return}var i=o.location.hash.replace("#","").split("/");switch(i[0]){case"category":g(i.length>1?i[1]:null);break;case"step2":b(i.length>1?i[1]:null,!1);break;case"step2skip3":b(i.length>1?i[1]:null,!0);break;case"step3":w();break;case"sendPayment":var u=[];for(var a=1;a<i.length;a++)u.push(i[a]);s.restore(u.join("/")),E(!1);break;case"step4":E();break;default:y()}e(n).one("hashchange",S)})(r.is(":visible"))},addToCart:function(r,i,s,o,u,a){var f=t.cart.manager;if(f===null)return;i=i||1,a=a?a:"",u=typeof u=="undefined"?!0:u,f.add(r,parseInt(i,10),s,o).done(function(){u?(e.imCookie("x5CartContinue",t.cart.ui.getWindow().location.href,{path:"/"}),t.utils.location(a+f.settings().indexpage)):n.alert(t.l10n.get("cart_product_added"))}).fail(function(e){n.alert(e.message)})},resumeShopping:function(){var n=e.imCookie("x5CartContinue",null,{path:"/"}),r=t.cart.ui.getWindow();n?r.location.href=n:r.location.href=t.cart.manager.settings().continue_shopping_page},updatePLOTo:null,updateProductListOptions:function(n,r,i,s){if(!t.cart.manager){var o=t.cart.ui;clearTimeout(o.updatePLOTo),o.updatePLOTo=setTimeout(function(){o.updateProductListOptions(n,r,i,s)},1e3);return}var u=t.cart.manager,a=u.store(n),f,l,c=e(r),h=e("#"+i+"_fullprice");a.option(c.val()),h.length&&(h.html(u.formatCurrency(a.fullPrice(s))),e("#"+i+"_price").html(u.formatCurrency(a.price(s))));if(a){e("#"+i+"_subopt").remove(),f=a.base().options[a.option()];if("suboptions"in f){var p=e('<select id="'+i+'_subopt" style="float: right; width: 47%;"/>');for(l=0;l<f.suboptions.length;l++)p.append('<option value="'+l+'">'+f.suboptions[l]+"</option>");p.val(0),c.width("47%").after(p)}else c.outerWidth("99%").css("float","none")}},updateWidget:function(){var n=t.cart.manager,r=t.cart.ui.updateWidget;if(n===null)return setTimeout(r,500);e(".widget_weight_total").text(t.utils.round(n.goodsWeight(),2)),e(".widget_quantity_total").text(n.count()),e(".widget_amount_total").text(n.formatCurrency(n.price(n.settings().vattype=="included"))),n.bind("x5cart.priceChanged",r).bind("x5cart.quantityChanged",r)},getStepStyleDom:function(n){var r=t.cart.ui.steps,i=0,s,o,u=t.l10n.get,a=e("body"),f=e('<div id="imCartStepsBanner" />');for(s=0;s<n;s++)i-=r.image.steps[s].height;for(s=0;s<r.image.steps.length;s++){var l=e("<span>"+u("cart_step"+(s+1)+"_header","Step description "+(s+1))+"</span>").css(r.font).css({"text-align":"center",position:"absolute",top:-1e3});a.append(l),o=l.outerWidth(!0),l.remove(),f.append(l.css({left:r.image.steps[n].offsetX[s]-o/2,top:r.image.steps[n].offsetY[s]})),s===n&&l.css("color",r.font.activeColor)}return f.width(r.image.width).height(r.image.steps[n].height).css({"background-image":"url('"+t.settings.currentPath+r.image.url+"')","background-position":"0 "+i+"px",margin:"0 auto",position:"relative"})}}),t.cart.loaded=!0}(_jq,x5engine,window);